<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SPanel - VHS Monochrome Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* --- CORE VARIABLES (Monochrome) --- */
        :root {
            --bg-dark: #020202;
            --text-main: #e0e0e0;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            overflow-x: hidden;
            font-family: 'Share Tech Mono', monospace;
            margin: 0;
            padding: 0;
        }

        /* --- FONTS --- */
        .font-mono { font-family: 'Share Tech Mono', monospace; }
        .font-cyber { font-family: 'Orbitron', sans-serif; }

        /* --- UI UTILS --- */
        .hidden { display: none !important; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #000; border-left: 1px solid #222; }
        ::-webkit-scrollbar-thumb { background: #444; border: 1px solid #fff; }
        ::-webkit-scrollbar-thumb:hover { background: #fff; }

        /* --- VHS EFFECTS --- */
        .vhs-overlay {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), 
                        linear-gradient(90deg, rgba(255, 255, 255, 0.02), rgba(255, 255, 255, 0.01), rgba(255, 255, 255, 0.02));
            background-size: 100% 3px, 3px 100%;
            z-index: 9999; pointer-events: none;
            animation: flicker 0.1s infinite;
        }
        .noise {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            pointer-events: none; z-index: 9998; opacity: 0.07;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='1'/%3E%3C/svg%3E");
        }
        .scanline {
            width: 100%; height: 10px; z-index: 9999;
            background: rgba(255, 255, 255, 0.05); opacity: 0.4;
            position: absolute; bottom: 100%;
            animation: scanline 8s linear infinite; pointer-events: none;
        }
        @keyframes flicker { 0% { opacity: 0.9; } 50% { opacity: 0.85; } 100% { opacity: 0.98; } }
        @keyframes scanline { 0% { bottom: 100%; } 100% { bottom: -20%; } }
        .retro-glow { text-shadow: 0 0 4px rgba(255, 255, 255, 0.6); }

        /* --- COMPONENTS --- */
        .cyber-card {
            background: #000000; border: 1px solid #333;
            box-shadow: 4px 4px 0px #222; transition: all 0.2s ease;
            position: relative; overflow: hidden;
        }
        .cyber-card:hover { transform: translate(-1px, -1px); border-color: #fff; box-shadow: 6px 6px 0px #fff; }
        
        .cyber-btn {
            background: #000; color: #fff; border: 1px solid #fff;
            text-transform: uppercase; font-family: 'Share Tech Mono', monospace;
            font-weight: bold; cursor: pointer; transition: all 0.2s;
            box-shadow: 2px 2px 0px #666; position: relative; overflow: hidden;
            display: flex; align-items: center; justify-content: center;
        }
        .cyber-btn:hover { background: #fff; color: #000; box-shadow: 4px 4px 0px #999; }
        .cyber-btn:active { transform: translate(1px, 1px); box-shadow: 1px 1px 0px #333; }
        
        .bg-retro-panel {
            background-color: #080808;
            background-image: linear-gradient(#1a1a1a 1px, transparent 1px), linear-gradient(90deg, #1a1a1a 1px, transparent 1px);
            background-size: 20px 20px;
        }
        .animate-text-flicker { animation: textFlicker 3s infinite; }
        @keyframes textFlicker { 0%, 100% { opacity: 1; } 96% { opacity: 0.4; } 98% { opacity: 0.2; } }

        /* --- LOADERS (MONOCHROME) --- */
        .loader-overlay { position: fixed; inset: 0; background: #000; z-index: 10000; display: flex; align-items: center; justify-content: center; color: white; }
        
        /* VCR (Dark Grey/Black) */
        .vcr-screen {
            background-color: #080808; width: 100%; height: 100%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            position: relative; animation: vcrFlicker 0.1s infinite;
        }
        .vcr-play { font-size: 4rem; text-shadow: 2px 2px 0px #fff; animation: blink 1s steps(2, start) infinite; }
        .vcr-tracking {
            position: absolute; width: 100%; height: 100%;
            background: repeating-linear-gradient(transparent 0px, transparent 2px, rgba(255,255,255,0.05) 3px);
            animation: scrollDown 4s linear infinite; pointer-events: none;
        }

        /* Bio Scan (White) */
        .bio-scan-container {
            background: #000; width: 100%; height: 100%; position: relative;
            display: flex; align-items: center; justify-content: center;
        }
        .bio-grid {
            position: absolute; inset: 0;
            background-image: linear-gradient(#222 1px, transparent 1px), linear-gradient(90deg, #222 1px, transparent 1px);
            background-size: 40px 40px; opacity: 0.5;
        }
        .bio-beam {
            position: absolute; top: 0; left: 0; width: 100%; height: 5px;
            background: #fff; box-shadow: 0 0 20px #fff;
            animation: bioScanMove 1.5s ease-in-out infinite alternate; z-index: 10;
        }
        .bio-text {
            color: #fff; border: 2px solid #fff; padding: 20px;
            background: rgba(0,0,0, 0.9); font-family: 'Orbitron', sans-serif;
            text-align: center; z-index: 20; box-shadow: 0 0 15px rgba(255,255,255,0.3);
        }

        /* Signal (White Noise) */
        .signal-container {
            background: #050505; width: 100%; height: 100%;
            display: flex; flex-direction: column; align-items: center; justify-content: center; overflow: hidden;
        }
        .signal-wave {
            width: 200vw; height: 200vh;
            background: repeating-radial-gradient(circle at 50% 50%, transparent 0, transparent 20px, rgba(255,255,255,0.1) 21px, rgba(255,255,255,0.02) 40px);
            position: absolute; animation: signalExpand 2s linear infinite;
        }
        .signal-text {
            font-size: 2rem; z-index: 10; background: #000; padding: 10px 30px; border-left: 5px solid white;
            animation: signalShake 0.2s infinite;
        }

        /* Data (White/Grey) */
        .data-melt-container {
            background: #000; width: 100%; height: 100%;
            display: flex; justify-content: center; align-items: center; flex-direction: column; position: relative; overflow: hidden;
        }
        .data-column {
            font-family: 'Share Tech Mono', monospace; font-size: 12px; color: #888;
            writing-mode: vertical-rl; text-orientation: upright;
            animation: dataFall 0.5s linear infinite; opacity: 0.7; position: absolute; top: -20px;
        }
        
        /* Animations */
        @keyframes scrollDown { from { background-position: 0 0; } to { background-position: 0 100%; } }
        @keyframes blink { to { visibility: hidden; } }
        @keyframes bioScanMove { from { top: 0%; } to { top: 100%; } }
        @keyframes signalExpand { from { transform: scale(0.5); opacity: 1; } to { transform: scale(1.5); opacity: 0; } }
        @keyframes signalShake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(2px); } 75% { transform: translateX(-2px); } }
        @keyframes dataFall { from { transform: translateY(-20px); } to { transform: translateY(20px); } }
        @keyframes crtOpen { 0% { transform: scaleY(0.005) scaleX(0); opacity: 0; } 50% { transform: scaleY(0.005) scaleX(1); opacity: 1; } 100% { transform: scaleY(1) scaleX(1); opacity: 1; } }
        .animate-crt-open { animation: crtOpen 0.8s cubic-bezier(0.23, 1, 0.32, 1) forwards; transform-origin: center; }
        
        .modal-backdrop {
            background: rgba(0, 0, 0, 0.98);
            backdrop-filter: blur(2px);
            position: fixed; inset: 0; z-index: 100;
            display: flex; align-items: center; justify-content: center;
            padding: 1rem;
        }
        .animate-terminal-drop { animation: terminalDrop 0.5s forwards; }
        @keyframes terminalDrop { from { transform: translateY(-100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    </style>
</head>
<body>

    <!-- VHS EFFECTS -->
    <div id="vhs-effects">
        <div class="vhs-overlay"></div>
        <div class="scanline"></div>
        <div class="noise"></div>
    </div>

    <!-- AUDIO -->
    <audio id="bgMusic" loop>
        <source src="https://cs1.mp3.pm/download/187817521/QzBEZm41YzRMOG8zOTc0cFZqbTltYXJyWUNvNVhJbWhtS1ZXTGZYQUdUVHFxK1MyRWo3U2VQalpTWGFkVXlNaEhCQVQ3clhhV2JxLzJxY0xDY0VpSU1jS1I1ekFJQjY5RExqSGJ5dDdUaSs4aThhNitrUnVQRWR6ekFOZjNGYWM/The_Neighbourhood_-_Softcore_Slowed_(mp3.pm).mp3" type="audio/mpeg">
    </audio>

    <!-- LOADER OVERLAY -->
    <div id="loader-overlay" class="loader-overlay hidden">
        <div id="loader-content" class="w-full h-full"></div>
    </div>

    <!-- WELCOME SCREEN -->
    <div id="welcome-screen" class="fixed inset-0 z-50 flex flex-col items-center justify-center bg-black text-white transition-opacity duration-1000">
        <div class="relative z-10 text-center space-y-8 p-6 max-w-2xl w-full">
            <div class="mb-4">
                <h1 class="text-6xl md:text-8xl font-cyber font-black tracking-tighter retro-glow animate-text-flicker">SPANEL</h1>
                <p class="text-xl font-mono tracking-[0.5em] text-gray-500 mt-2">MONO_CHROME // V.1.0</p>
            </div>

            <div class="border-2 border-white p-8 bg-black relative overflow-hidden group hover:border-gray-400 transition-colors">
                <div class="absolute inset-0 bg-white opacity-0 group-hover:opacity-10 transition-opacity duration-500"></div>
                <h2 class="text-xl font-mono mb-6 border-b border-gray-800 pb-2">SYSTEM ACCESS REQUEST</h2>
                <p class="font-mono text-sm text-gray-400 mb-8 leading-relaxed">
                    AUTHORIZED PERSONNEL ONLY.<br>
                    <span class="text-white font-bold">Version created by Mazikeen helper: DisabilityBG</span><br>
                    MAZE // BLACK_EDITION
                </p>
                <button onclick="app.enterSystem()" class="w-full cyber-btn py-4 text-xl tracking-widest">
                    [ CROSSING THE LINE ]
                </button>
            </div>
            <div class="text-[10px] font-mono text-gray-700 uppercase tracking-widest mt-12">
                Don't copy us. We see you watching.
            </div>
        </div>
        <div class="absolute inset-0 z-0 opacity-10 pointer-events-none" 
             style="background-image: linear-gradient(#333 1px, transparent 1px), linear-gradient(90deg, #333 1px, transparent 1px); background-size: 30px 30px;">
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main-content" class="relative min-h-screen flex flex-col hidden">
        <canvas id="bgCanvas" class="fixed inset-0 w-full h-full -z-10 opacity-20"></canvas>

        <!-- NAV -->
        <nav class="border-b border-white/30 bg-black/95 p-4 md:px-8 flex flex-col md:flex-row justify-between items-center gap-4 z-20 backdrop-blur-md">
            <div class="text-2xl font-cyber font-bold tracking-widest text-white flex items-center gap-2">
                <i class="fas fa-ghost"></i> S<span class="text-gray-600">PANEL</span>
            </div>
            <div class="flex flex-wrap items-center justify-center gap-4 font-mono text-xs md:text-sm">
                <button onclick="app.openNavModal('modules')" class="hover:text-white text-gray-400 hover:bg-white/10 px-2 py-1 transition-all">[ MODULES ]</button>
                <button onclick="app.openNavModal('docs')" class="hover:text-white text-gray-400 hover:bg-white/10 px-2 py-1 transition-all">[ MANUALS ]</button>
                <button onclick="app.openNavModal('security')" class="hover:text-white text-gray-400 hover:bg-white/10 px-2 py-1 transition-all">[ THREATS ]</button>
                <button onclick="app.toggleVhs()" class="cyber-btn border px-3 py-1 text-[10px] ml-2 tracking-widest">
                    VHS: <span id="vhs-status">ON</span>
                </button>
            </div>
        </nav>

        <!-- HERO -->
        <main class="flex-grow flex flex-col items-center justify-center p-6 text-center z-10 mt-8 md:mt-0">
            <div class="mb-8 flex items-center gap-2 border border-gray-800 px-4 py-1 bg-black animate-pulse">
                <span class="w-1.5 h-1.5 bg-white animate-pulse"></span>
                <span class="font-mono text-[10px] text-gray-400 tracking-[0.2em] uppercase">Status: Undetected</span>
            </div>

            <h1 class="text-5xl md:text-7xl font-cyber font-black mb-6 text-white tracking-tighter">
                SPANEL<br><span class="text-gray-600 text-3xl md:text-5xl">INJECTOR // V2</span>
            </h1>

            <p class="max-w-2xl text-gray-400 mb-12 font-mono text-xs md:text-sm border-l-2 border-white pl-6 text-left bg-gradient-to-r from-white/5 to-transparent p-4 italic">
                "I lowered the <span class="text-white font-bold not-italic">level</span> to meet you. Admins watch, legit players complain and still, you never <span class="text-white font-bold not-italic">caught up with</span> us."
            </p>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 w-full max-w-3xl">
                <button onclick="app.triggerInstaller()" class="cyber-btn py-4 flex items-center justify-center gap-2 group hover:scale-[1.02] transition-transform">
                    <i class="fas fa-bolt group-hover:animate-pulse"></i> GET FILE
                </button>
                <button onclick="app.openDiscord()" class="cyber-btn bg-black text-white hover:bg-white hover:text-black py-4 flex items-center justify-center gap-2 hover:scale-[1.02] transition-transform">
                    <i class="fab fa-discord"></i> DISCORD
                </button>
                <button onclick="app.openLuaObfuscator()" class="cyber-btn bg-black border-gray-500 text-gray-400 hover:border-white hover:text-white py-4 flex items-center justify-center gap-2 hover:scale-[1.02] transition-transform">
                    <i class="fas fa-code"></i> LUA OBFUSCATOR
                </button>
            </div>
            
            <button onclick="app.openCreatorDiscord()" class="mt-8 w-full max-w-md border border-dotted border-gray-700 py-2 text-gray-600 hover:text-white hover:border-white hover:bg-white/5 transition font-mono text-[10px] tracking-[0.3em] uppercase">
                Start Chat with Creator
            </button>
        </main>

        <!-- FEATURES -->
        <section class="max-w-7xl mx-auto w-full px-6 grid grid-cols-1 md:grid-cols-3 gap-6 mb-16 z-10">
            <div onclick="app.openYTPlayer()" class="cyber-card p-6 cursor-pointer group bg-retro-panel">
                <div class="flex justify-between items-start mb-4">
                     <div class="text-3xl text-gray-300 group-hover:text-white transition-colors"><i class="fab fa-youtube"></i></div>
                     <div class="text-[10px] font-mono text-gray-600">MOD_01</div>
                </div>
                <h3 class="text-lg font-cyber font-bold mb-2 text-white group-hover:translate-x-1 transition-transform">YOUTUBE DECK</h3>
                <p class="text-gray-500 font-mono text-xs leading-relaxed">Secure video stream container.</p>
            </div>

            <div onclick="app.openKeyboardModal()" class="cyber-card p-6 cursor-pointer group bg-retro-panel">
                <div class="flex justify-between items-start mb-4">
                     <div class="text-3xl text-gray-300 group-hover:text-white transition-colors"><i class="fas fa-keyboard"></i></div>
                     <div class="text-[10px] font-mono text-gray-600">MOD_02</div>
                </div>
                <h3 class="text-lg font-cyber font-bold mb-2 text-white group-hover:translate-x-1 transition-transform">GUI TERMINAL</h3>
                <p class="text-gray-500 font-mono text-xs leading-relaxed">Virtual input device.</p>
            </div>

            <div onclick="app.triggerFileUpload()" class="cyber-card p-6 cursor-pointer group bg-retro-panel">
                <div class="flex justify-between items-start mb-4">
                     <div class="text-3xl text-gray-300 group-hover:text-white transition-colors"><i class="fas fa-file-shield"></i></div>
                     <div class="text-[10px] font-mono text-gray-600">MOD_03</div>
                </div>
                <h3 class="text-lg font-cyber font-bold mb-2 text-white group-hover:translate-x-1 transition-transform">FILE SHIFTER</h3>
                <p class="text-gray-500 font-mono text-xs leading-relaxed">Ghost Protocol Byte-Shift.</p>
            </div>
        </section>

        <footer class="text-center py-6 text-[10px] text-gray-700 font-mono border-t border-gray-900 z-10 bg-black">
            SPANEL © 2025 | MAZIKEEN HELPER: DISABILITYBG
        </footer>

        <!-- WIDGETS -->
        <div class="fixed bottom-4 left-4 z-50 bg-black border border-white p-2 font-mono text-[10px] hidden md:block shadow-[2px_2px_0px_#333]">
            <div class="flex items-center gap-2 border-b border-gray-800 pb-1 mb-1">
                <span class="w-1.5 h-1.5 bg-white animate-pulse"></span>
                <span>NET_LIVE: <span id="live-visits" class="font-bold text-white">42</span></span>
            </div>
            <div class="text-gray-500">TOTAL: <span id="total-visits">14,205</span></div>
        </div>

        <div onclick="app.toggleMute()" class="fixed bottom-4 right-4 z-50 w-8 h-8 bg-black border border-white flex items-center justify-center cursor-pointer hover:bg-white hover:text-black transition shadow-[2px_2px_0px_#333]">
            <i id="volume-icon" class="fas fa-volume-up text-xs"></i>
        </div>
    </div>

    <!-- MODAL -->
    <div id="modal-container" class="modal-backdrop hidden" onclick="app.closeModal()">
        <div class="cyber-card w-full max-w-2xl bg-black border border-white p-0 relative flex flex-col max-h-[90vh] shadow-[0_0_50px_rgba(255,255,255,0.1)]" onclick="event.stopPropagation()">
            <!-- Header -->
            <div class="bg-white text-black p-3 flex justify-between items-center border-b border-gray-800">
                <div class="font-cyber font-bold tracking-widest flex items-center gap-2 text-sm">
                    <i id="modal-icon" class="fas"></i>
                    <span id="modal-title">TITLE</span>
                </div>
                <button onclick="app.closeModal()" class="hover:bg-black hover:text-white px-2 font-bold transition-colors">X</button>
            </div>
            <!-- Content -->
            <div class="p-6 overflow-y-auto flex-grow font-mono text-sm space-y-6 bg-black">
                <div class="border-b border-dashed border-gray-800 pb-4 text-xs text-gray-500 flex justify-between">
                    <span id="modal-id">ID: 0x00</span>
                    <span id="modal-desc">Description</span>
                </div>
                <div id="modal-body"></div>
            </div>
        </div>
    </div>

    <!-- INSTALLER OVERLAY -->
    <div id="installer-overlay" class="fixed inset-0 z-[200] bg-black flex flex-col font-mono text-white hidden">
        <div class="h-12 border-b border-gray-800 flex items-center justify-between px-6 bg-black">
            <div class="flex items-center gap-2">
                <i class="fas fa-terminal text-white text-xs"></i>
                <span class="tracking-widest font-bold text-xs text-gray-400">ROOT_ACCESS // INSTALLER</span>
            </div>
            <div class="flex gap-4 text-[10px]">
                <button onclick="app.closeInstaller()" class="hover:text-white text-gray-500 hover:bg-white/10 px-3 py-1 transition">[ ABORT ]</button>
            </div>
        </div>
        <div class="flex-grow flex items-center justify-center p-4">
            <div class="w-full max-w-4xl border border-white bg-black p-1 grid grid-cols-1 md:grid-cols-2 gap-0 shadow-[0_0_100px_rgba(255,255,255,0.05)]">
                <div class="p-8 border-r border-gray-800 flex flex-col justify-between relative overflow-hidden">
                    <div class="absolute inset-0 bg-white/5 pointer-events-none"></div>
                    <div class="relative z-10">
                        <div class="inline-block border border-white text-white px-2 py-0.5 text-[10px] mb-6 font-bold">SECURE_BOOT</div>
                        <h1 class="text-4xl font-black mb-2 tracking-tighter text-white">SPANEL</h1>
                        <h2 class="text-sm text-gray-500 mb-8 tracking-widest">INSTALLATION WIZARD</h2>
                        <div class="space-y-4 text-xs text-gray-400 font-mono">
                             <div class="flex items-center gap-3"><div class="w-2 h-2 bg-white"></div> <span>Initializing Aegis...</span></div>
                             <div class="flex items-center gap-3"><div class="w-2 h-2 bg-white"></div> <span>Loading Ghost Protocol...</span></div>
                             <div class="flex items-center gap-3"><div class="w-2 h-2 bg-gray-600"></div> <span>Verifying Hash...</span></div>
                        </div>
                    </div>
                </div>
                <div class="p-6 flex flex-col bg-[#050505]">
                    <div class="bg-black border border-gray-800 p-2 mb-4 text-[10px] text-gray-600 flex justify-between font-mono">
                        <span>root@spanel:~# ./deploy_payload.sh</span>
                        <span>BASH</span>
                    </div>
                    <div id="terminal-logs" class="flex-grow font-mono text-[11px] space-y-1 text-gray-400 overflow-hidden mb-6 h-48 border-l border-gray-800 pl-4"></div>
                    <button id="dlBtn" onclick="app.executeDownload()" class="w-full bg-white text-black font-bold py-4 hover:bg-gray-200 transition text-xs tracking-[0.2em] relative overflow-hidden border border-white">
                        <span class="relative z-10"><i class="fas fa-download mr-2"></i> INITIATE DEPLOYMENT</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- HIDDEN INPUT -->
    <input type="file" id="fileInput" hidden accept=".lua,.txt">

    <script>
        const app = {
            state: {
                vhs: true,
                muted: false,
                keyboardBuffer: ''
            },
            
            // --- CONSTANTS ---
            DOWNLOAD_URL: "https://astriidybg.github.io/Spanel2/",
            DISCORD_URL: "https://discord.gg/MpcyR24e",
            CREATOR_DISCORD_ID: "123456789012345678",

            // --- INIT ---
            init: function() {
                this.initVisits();
                this.initCanvas();
                this.setupAudio();
                
                document.getElementById('fileInput').addEventListener('change', (e) => this.handleFileSelect(e));
            },

            // --- AUDIO ---
            audioCtx: null,
            setupAudio: function() {
                try {
                    const AudioContext = window.AudioContext || window.webkitAudioContext;
                    this.audioCtx = new AudioContext();
                } catch(e) {}
            },
            playUiSound: function(freq = 800, type = 'sine') {
                if(!this.audioCtx) this.setupAudio();
                if(!this.audioCtx) return;
                if(this.audioCtx.state === 'suspended') this.audioCtx.resume();

                const osc = this.audioCtx.createOscillator();
                const gain = this.audioCtx.createGain();
                osc.type = type;
                osc.frequency.setValueAtTime(freq, this.audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(freq/2, this.audioCtx.currentTime + 0.1);
                gain.gain.setValueAtTime(0.05, this.audioCtx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.001, this.audioCtx.currentTime + 0.1);
                osc.connect(gain);
                gain.connect(this.audioCtx.destination);
                osc.start();
                osc.stop(this.audioCtx.currentTime + 0.1);
            },
            toggleMute: function() {
                this.state.muted = !this.state.muted;
                const audio = document.getElementById('bgMusic');
                audio.muted = this.state.muted;
                const icon = document.getElementById('volume-icon');
                icon.className = this.state.muted ? 'fas fa-volume-mute text-xs' : 'fas fa-volume-up text-xs';
                this.playUiSound();
            },

            // --- THEME ---
            toggleVhs: function() {
                this.state.vhs = !this.state.vhs;
                document.getElementById('vhs-effects').classList.toggle('hidden', !this.state.vhs);
                document.getElementById('vhs-status').innerText = this.state.vhs ? 'ON' : 'OFF';
                this.playUiSound();
            },

            // --- NAVIGATION / LOADING ---
            enterSystem: async function() {
                this.playUiSound();
                await this.startLoading('glitch', 'BREACHING FIREWALL...', 1500);
                
                document.getElementById('welcome-screen').classList.add('hidden');
                document.getElementById('main-content').classList.remove('hidden');
                document.getElementById('main-content').classList.add('animate-crt-open');

                const audio = document.getElementById('bgMusic');
                audio.volume = 0.4;
                audio.play().catch(e => console.log('Audio blocked', e));
            },

            startLoading: function(type, msg, duration = 1500) {
                return new Promise(resolve => {
                    const overlay = document.getElementById('loader-overlay');
                    const content = document.getElementById('loader-content');
                    overlay.classList.remove('hidden');
                    
                    let html = '';
                    // Generate HTML based on monochrome design
                    if(type === 'vcr') {
                        html = `
                            <div class="vcr-screen">
                                <div class="vcr-tracking"></div>
                                <div class="absolute top-8 left-8 text-xl font-mono">AV-1</div>
                                <div class="vcr-play font-cyber">PLAY ►</div>
                                <div class="absolute bottom-8 right-8 text-xl font-mono">SP 0:00:01</div>
                                <div class="mt-8 text-sm opacity-70 animate-pulse font-mono">${msg}</div>
                            </div>`;
                    } else if (type === 'bio') {
                        html = `
                            <div class="bio-scan-container">
                                <div class="bio-grid"></div>
                                <div class="bio-beam"></div>
                                <div class="bio-text">
                                    <div class="text-4xl mb-2"><i class="fas fa-biohazard fa-spin"></i></div>
                                    <div class="text-xl tracking-widest font-cyber">SECURITY SCAN</div>
                                    <div class="text-xs mt-2 font-mono uppercase">${msg}</div>
                                </div>
                            </div>`;
                    } else if (type === 'signal') {
                        html = `
                             <div class="signal-container">
                                <div class="signal-wave"></div>
                                <div class="signal-wave" style="animation-delay: 0.5s"></div>
                                <div class="signal-text border-2 border-white">
                                    <i class="fas fa-satellite-dish mr-2"></i> SIGNAL FOUND
                                </div>
                                <div class="mt-4 font-mono text-xs text-black bg-white px-2 py-1 font-bold">${msg}</div>
                            </div>`;
                    } else if (type === 'data') {
                        let cols = '';
                        for(let i=0; i<10; i++) cols += `<div class="data-column" style="left:${i*10}%; animation-duration:${0.3 + i*0.1}s">101010101010</div>`;
                        html = `
                            <div class="data-melt-container">
                                ${cols}
                                <div class="bg-black text-white p-6 border border-white z-10 text-center">
                                    <div class="text-2xl font-bold mb-1 font-cyber">COMPILING...</div>
                                    <div class="text-[10px] font-mono text-gray-400">${msg}</div>
                                </div>
                            </div>`;
                    } else {
                        // Glitch
                         html = `
                            <div class="flex flex-col items-center justify-center h-full relative">
                                <h1 class="text-6xl text-white font-black font-cyber animate-pulse">${msg}</h1>
                                <div class="mt-4 text-center font-mono text-white font-bold tracking-widest text-sm animate-pulse border border-white px-2">ACCESS GRANTED</div>
                            </div>`;
                    }

                    content.innerHTML = html;
                    this.playUiSound();

                    setTimeout(() => {
                        overlay.classList.add('hidden');
                        content.innerHTML = '';
                        resolve();
                    }, duration);
                });
            },

            // --- MODALS ---
            closeModal: function() {
                this.playUiSound();
                document.getElementById('modal-container').classList.add('hidden');
            },

            openNavModal: async function(key) {
                await this.startLoading('glitch', 'FETCHING DATA...', 800);
                const data = {
                    modules: { title: "CORE MODULES", id: "0xMOD-LIST", desc: "Active kernel modules", icon: "fa-cubes", content: [{name: "CORE_KERNEL", tag: "RUNNING"}, {name: "LUA_BRIDGE", tag: "ACTIVE"}] },
                    docs: { title: "MANUALS", id: "0xDOC-V2", desc: "Technical reference", icon: "fa-book", content: [{name: "API Reference v2.5", tag: "PDF"}] },
                    security: { title: "THREAT SCAN", id: "0xSEC-CHK", desc: "Security analysis", icon: "fa-lock", content: [{name: "VAC Status", tag: "UNDETECTED"}] }
                };
                
                if(data[key]) {
                    let html = '';
                    data[key].content.forEach(item => {
                        html += `
                        <div class="flex justify-between items-center border-b border-gray-900 py-3 hover:bg-white/5 px-2 transition">
                           <span class="text-gray-300">${item.name}</span>
                           <span class="bg-white text-black font-bold text-[10px] px-2 py-0.5">${item.tag}</span>
                       </div>`;
                    });
                    this.showModal(data[key].title, data[key].id, data[key].desc, data[key].icon, html);
                }
            },

            openKeyboardModal: async function() {
                await this.startLoading('bio', 'INITIALIZING DRIVER...', 1500);
                this.state.keyboardBuffer = '';
                
                const rows = ["1234567890", "QWERTYUIOP", "ASDFGHJKL", "ZXCVBNM"];
                let keysHtml = '<div class="flex flex-col gap-2 select-none">';
                rows.forEach(row => {
                    keysHtml += '<div class="flex justify-center gap-1">';
                    row.split('').forEach(char => {
                        keysHtml += `<button onmousedown="app.typeKey('${char}')" class="bg-black border border-gray-600 text-gray-300 hover:border-white hover:text-white w-8 h-10 md:w-10 md:h-12 font-bold active:translate-y-0.5 transition-all">${char}</button>`;
                    });
                    keysHtml += '</div>';
                });
                keysHtml += '<div class="flex justify-center mt-2"><button onmousedown="app.typeKey(\' \')" class="bg-black border border-gray-600 text-gray-300 hover:border-white hover:text-white w-64 h-8 font-bold text-xs uppercase tracking-widest active:translate-y-0.5 transition-all">Spacebar</button></div></div>';
                
                const html = `
                    <div id="kbd-display" class="bg-gray-900 border border-gray-700 p-4 min-h-[60px] mb-4 text-white whitespace-pre-wrap break-all shadow-inner font-bold text-lg tracking-wider">_</div>
                    ${keysHtml}
                    <div class="grid grid-cols-2 gap-4 mt-6">
                        <button onclick="app.copyKeyboard()" class="cyber-btn py-3 text-xs">COPY SEQUENCE</button>
                        <button onclick="app.clearKeyboard()" class="cyber-btn py-3 text-xs border-white text-white">CLEAR BUFFER</button>
                    </div>
                `;
                
                this.showModal('GUI KEYBOARD', '0xGUI-KBD', 'Virtual input device', 'fa-keyboard', html);
            },

            typeKey: function(char) {
                this.playUiSound(1000, 'square');
                this.state.keyboardBuffer += char;
                document.getElementById('kbd-display').innerText = this.state.keyboardBuffer;
            },
            clearKeyboard: function() { this.state.keyboardBuffer = ''; document.getElementById('kbd-display').innerText = '_'; this.playUiSound(); },
            copyKeyboard: function() { navigator.clipboard.writeText(this.state.keyboardBuffer); this.playUiSound(); },

            openLuaObfuscator: async function() {
                await this.startLoading('data', 'LOADING ENCRYPTION...', 1500);
                const html = `
                    <div class="relative">
                        <textarea id="lua-input" placeholder="-- Paste Lua Code Here" class="w-full h-32 bg-gray-900/50 border border-gray-700 text-gray-300 p-3 text-xs outline-none focus:border-white transition-colors font-mono"></textarea>
                        <div class="absolute top-0 right-0 p-1 text-[10px] text-gray-600">LUA 5.1</div>
                    </div>
                    <button onclick="app.doObfuscate()" class="w-full cyber-btn py-3 my-4">INITIATE OBFUSCATION</button>
                    <div class="relative">
                        <textarea id="lua-output" readonly placeholder="-- Output will appear here" class="w-full h-32 bg-black border border-gray-800 text-gray-400 p-3 text-xs outline-none resize-none font-mono"></textarea>
                         <div class="absolute top-0 right-0 p-1 text-[10px] text-gray-600">READ ONLY</div>
                    </div>
                `;
                this.showModal('LUA OBFUSCATOR', '0xLUA-ENC', 'Browser-side processing', 'fa-code', html);
            },

            doObfuscate: function() {
                const input = document.getElementById('lua-input').value;
                if(!input) return;
                let decimalStr = "";
                for (let i = 0; i < input.length; i++) decimalStr += "\\" + input.charCodeAt(i);
                document.getElementById('lua-output').value = `loadstring("${decimalStr}")()`;
                this.playUiSound(1200, 'square');
            },

            triggerFileUpload: function() { document.getElementById('fileInput').click(); },
            handleFileSelect: async function(e) {
                const file = e.target.files[0];
                if(!file) return;
                await this.startLoading('bio', 'ANALYZING STRUCTURE...', 2000);
                const reader = new FileReader();
                reader.onload = (ev) => {
                    const content = ev.target.result;
                    let decimalStr = "";
                    for (let i = 0; i < content.length; i++) decimalStr += "\\" + content.charCodeAt(i);
                    const result = `loadstring("${decimalStr}")()`;
                    
                    const html = `
                        <textarea readonly class="w-full h-48 bg-black border border-gray-800 text-gray-400 p-3 text-xs outline-none resize-none font-mono">${result}</textarea>
                        <button onclick="navigator.clipboard.writeText(document.querySelector('textarea').value)" class="w-full cyber-btn py-3 mt-6">COPY BYTECODE</button>
                    `;
                    this.showModal('FILE SHIFTER', '0xFILE-ENC', 'Ghost Protocol applied', 'fa-file-code', html);
                };
                reader.readAsText(file);
                e.target.value = '';
            },

            openYTPlayer: async function() {
                await this.startLoading('vcr', 'INSERTING TAPE...', 2000);
                const html = `
                    <div class="space-y-4">
                        <div class="flex gap-2">
                            <input id="yt-input" type="text" placeholder="Paste YouTube URL..." class="flex-grow bg-black border border-gray-700 py-2 px-3 text-white text-xs outline-none focus:border-white transition">
                            <button onclick="app.loadYT()" class="cyber-btn px-4 text-xs">LOAD</button>
                        </div>
                        <div id="yt-frame" class="aspect-video w-full border border-gray-800 bg-black flex items-center justify-center text-gray-700 text-xs">[ NO SIGNAL ]</div>
                    </div>
                `;
                this.showModal('YOUTUBE DECK', '0xYT-STREAM', 'Secure media container', 'fa-youtube', html);
            },
            
            loadYT: function() {
                const link = document.getElementById('yt-input').value;
                const regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/;
                const match = link.match(regExp);
                if (match && match[7].length === 11) {
                    const videoId = match[7];
                    document.getElementById('yt-frame').innerHTML = `<iframe src="https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0&modestbranding=1" class="w-full h-full" frameborder="0" allowfullscreen></iframe>`;
                    this.playUiSound();
                } else {
                    alert('Invalid URL');
                }
            },

            showModal: function(title, id, desc, icon, contentHtml) {
                document.getElementById('modal-title').innerText = title;
                document.getElementById('modal-id').innerText = "ID: " + id;
                document.getElementById('modal-desc').innerText = desc;
                document.getElementById('modal-icon').className = "fas " + icon;
                document.getElementById('modal-body').innerHTML = contentHtml;
                document.getElementById('modal-container').classList.remove('hidden');
                this.playUiSound();
            },

            // --- LINKS ---
            openDiscord: async function() { await this.startLoading('signal', 'UPLINK ESTABLISHED', 1500); window.open(this.DISCORD_URL); },
            openCreatorDiscord: async function() { await this.startLoading('signal', 'LOCATING ID...', 1500); window.open(`https://discord.com/users/${this.CREATOR_DISCORD_ID}`); },

            // --- INSTALLER ---
            triggerInstaller: async function() {
                this.playUiSound();
                await this.startLoading('bio', 'ROOT ACCESS...', 2000);
                document.getElementById('main-content').classList.add('hidden');
                document.getElementById('installer-overlay').classList.remove('hidden');
                this.runTerminal();
            },
            closeInstaller: function() {
                this.playUiSound();
                document.getElementById('installer-overlay').classList.add('hidden');
                document.getElementById('main-content').classList.remove('hidden');
            },
            runTerminal: function() {
                const container = document.getElementById('terminal-logs');
                container.innerHTML = '';
                const logs = [
                    { text: "[BOOT] INITIALIZING VERIFICATION...", type: 'text-white' },
                    { text: "[AUTH] CHECKING ADMIN PRIVILEGES...", type: 'text-gray-400' },
                    { text: "[SEC] Aegis Sentinel Monitoring.", type: 'text-white' },
                    { text: "[SCAN] User profile under analysis...", type: 'text-white' },
                    { text: "[SYS] Permission matrix loaded.", type: 'font-bold text-white' },
                    { text: "[NET] Identity validation in progress...", type: 'text-white' },
                    { text: "[STATUS] No interference detected.", type: 'font-bold text-white' },
                    { text: "[READY] Awaiting payload deployment...", type: 'font-bold text-white' }
                ];
                let i = 0;
                const addLog = () => {
                    if(i < logs.length) {
                        const time = new Date().toLocaleTimeString('en-US', {hour12: false});
                        const div = document.createElement('div');
                        div.className = 'break-words';
                        div.innerHTML = `<span class="text-gray-600">[${time}]</span> <span class="${logs[i].type}">${logs[i].text}</span>`;
                        container.appendChild(div);
                        this.playUiSound(1000, 'square');
                        i++;
                        setTimeout(addLog, 400);
                    }
                };
                addLog();
            },
            executeDownload: function() {
                this.playUiSound();
                const btn = document.getElementById('dlBtn');
                btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> REDIRECTING...';
                setTimeout(() => {
                    window.open(this.DOWNLOAD_URL, '_blank');
                    setTimeout(() => btn.innerHTML = '<i class="fas fa-download mr-2"></i> INITIATE DEPLOYMENT', 2000);
                }, 1500);
            },

            // --- STATS / CANVAS ---
            initVisits: function() {
                let count = localStorage.getItem('spanel_visits') || 14205;
                count++;
                localStorage.setItem('spanel_visits', count);
                document.getElementById('total-visits').innerText = parseInt(count).toLocaleString();
                setInterval(() => {
                    let val = parseInt(document.getElementById('live-visits').innerText);
                    val += Math.floor(Math.random() * 3) - 1;
                    if(val < 10) val = 10;
                    document.getElementById('live-visits').innerText = val;
                }, 5000);
            },
            initCanvas: function() {
                const canvas = document.getElementById('bgCanvas');
                const ctx = canvas.getContext('2d');
                let w = canvas.width = window.innerWidth;
                let h = canvas.height = window.innerHeight;
                window.onresize = () => { w = canvas.width = window.innerWidth; h = canvas.height = window.innerHeight; };
                
                const parts = [];
                for(let i=0; i<80; i++) parts.push({x:Math.random()*w, y:Math.random()*h, vx:(Math.random()-.5)*.5, vy:(Math.random()-.5)*.5, s:Math.random()*1.5+.5, a:Math.random()*.3+.05});
                
                const anim = () => {
                    ctx.clearRect(0,0,w,h);
                    ctx.fillStyle = 'rgba(255,255,255,0.4)';
                    parts.forEach(p => {
                        p.x+=p.vx; p.y+=p.vy;
                        if(p.x<0||p.x>w) p.x=Math.random()*w;
                        if(p.y<0||p.y>h) p.y=Math.random()*h;
                        ctx.globalAlpha=p.a; ctx.beginPath(); ctx.arc(p.x,p.y,p.s,0,Math.PI*2); ctx.fill();
                    });
                    ctx.strokeStyle = 'rgba(255,255,255,0.03)';
                    ctx.lineWidth = 1;
                    ctx.beginPath();
                    for(let i=0; i<parts.length; i++) {
                        for(let j=i+1; j<parts.length; j++) {
                            const d = Math.hypot(parts[i].x-parts[j].x, parts[i].y-parts[j].y);
                            if(d<80) { ctx.moveTo(parts[i].x, parts[i].y); ctx.lineTo(parts[j].x, parts[j].y); }
                        }
                    }
                    ctx.stroke();
                    requestAnimationFrame(anim);
                };
                anim();
            }
        };

        document.addEventListener('DOMContentLoaded', () => app.init());
    </script>
</body>
</html>
